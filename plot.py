import matplotlib.pyplot as plt
import numpy as np

raw_data = [(2048, 1.280700445175171, 8.940696716308594e-05), (4096, 0.261974573135376, 0.00017952919006347656), (8192, 0.24864768981933594, 0.00036644935607910156), (16384, 0.20994997024536133, 0.0005559921264648438), (32768, 0.19372057914733887, 0.001302957534790039), (65536, 0.175187349319458, 0.0022127628326416016), (131072, 0.15537810325622559, 0.00477290153503418), (262144, 0.18303608894348145, 0.009089231491088867), (524288, 0.23831820487976074, 0.017693758010864258), (1048576, 0.28464293479919434, 0.03470468521118164), (2097152, 0.3589444160461426, 0.06902599334716797), (4194304, 0.5789427757263184, 0.18380498886108398), (8388608, 1.0571215152740479, 0.2764465808868408)]

sizes = np.log2([i[0] for i in raw_data])
# spark_runtimes = [i[1] for i in raw_data]
# normal_runtimes = [i[2] for i in raw_data]
spark_runtimes = np.log([i[1] for i in raw_data])
normal_runtimes = np.log([i[2] for i in raw_data])

plt.plot(sizes, normal_runtimes, label='normal')
plt.plot(sizes, spark_runtimes, label='spark')
plt.xlabel('sizes (log scale)')
plt.ylabel('runtimes (log scale)')
plt.legend()
plt.savefig('plt.png')